---
title: MCP Server Overview
description: Model Context Protocol server exposing policy evaluation tools for AI agents.
---

# MCP Server

The Guardrail-Sim MCP server exposes policy evaluation tools that AI agents can call directly. It implements the [Model Context Protocol](https://modelcontextprotocol.io/) (November 2025 specification).

## Available Tools

| Tool                                                        | Description                                   |
| ----------------------------------------------------------- | --------------------------------------------- |
| [`evaluate_policy`](/docs/mcp-server/evaluate-policy)       | Evaluate a discount against the active policy |
| [`get_policy_summary`](/docs/mcp-server/get-policy-summary) | Get human-readable policy explanation         |
| [`get_max_discount`](/docs/mcp-server/get-max-discount)     | Calculate maximum allowed discount            |

## Available Resources

| URI                           | Description                               |
| ----------------------------- | ----------------------------------------- |
| `guardrail://policies/active` | The currently active policy configuration |

## Quick Start

### Claude Desktop

Add to your Claude Desktop configuration (`claude_desktop_config.json`):

```json
{
  "mcpServers": {
    "guardrail-sim": {
      "command": "node",
      "args": ["./packages/mcp-server/dist/index.js"]
    }
  }
}
```

### Cursor / VS Code

For Cursor or other MCP-compatible editors, point to the built server:

```json
{
  "mcp": {
    "servers": {
      "guardrail-sim": {
        "command": "node",
        "args": ["/path/to/guardrail-sim/packages/mcp-server/dist/index.js"]
      }
    }
  }
}
```

### Programmatic Usage

```typescript
import { Client } from '@modelcontextprotocol/sdk/client/index.js';
import { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';

const transport = new StdioClientTransport({
  command: 'node',
  args: ['./packages/mcp-server/dist/index.js'],
});

const client = new Client({ name: 'my-app', version: '1.0.0' }, { capabilities: {} });
await client.connect(transport);

// Now you can call tools
const result = await client.callTool({
  name: 'evaluate_policy',
  arguments: {
    order: { order_value: 5000, quantity: 100, product_margin: 0.4 },
    proposed_discount: 0.12,
  },
});
```

## Server Capabilities

The server advertises these MCP capabilities:

```json
{
  "capabilities": {
    "tools": {},
    "resources": {}
  }
}
```

## Key Design Decisions

### Deterministic Responses

Every tool call returns deterministic results. Given the same input, you'll always get the same output. This is crucial for:

- **Auditing**: You can replay any decision
- **Testing**: Results are predictable and testable
- **Compliance**: Policy enforcement is provable

### Stateless Operation

The MCP server is stateless. Each request is evaluated independently against the active policy. The server doesn't maintain session state or remember previous evaluations.

### JSON Responses

All tools return JSON-formatted responses for easy parsing:

```json
{
  "approved": true,
  "violations": [],
  "applied_rules": ["margin_floor", "max_discount", "volume_tier"],
  "calculated_margin": 0.28,
  "policy_id": "default",
  "policy_name": "Default Pricing Policy"
}
```

## Error Handling

Tool calls that encounter errors return structured error responses:

```json
{
  "error": true,
  "code": "TOOL_ERROR",
  "message": "Description of what went wrong"
}
```

Common error codes:

| Code               | Description                 |
| ------------------ | --------------------------- |
| `UNKNOWN_TOOL`     | Tool name not recognized    |
| `TOOL_ERROR`       | Error during tool execution |
| `VALIDATION_ERROR` | Invalid input parameters    |

## Next Steps

- [evaluate_policy](/docs/mcp-server/evaluate-policy) - Core evaluation tool
- [get_policy_summary](/docs/mcp-server/get-policy-summary) - Policy explanation
- [get_max_discount](/docs/mcp-server/get-max-discount) - Max discount calculator
- [Resources](/docs/mcp-server/resources) - Available MCP resources
